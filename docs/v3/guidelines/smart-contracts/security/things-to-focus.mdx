import Feedback from '@site/src/components/Feedback';

# Things to focus on while working with TON Blockchain

In this article, we will review and discuss the elements to consider for those who want to develop TON applications.

## Checklist

### 1. Name collisions

FunC variable and function names may contain many valid characters; e.g., `var++`, `foo-bar+baz`. Only function names may start with `~` or `.`.

When writing and reviewing FunC code, use a linter.

- [IDE plugins](/v3/documentation/smart-contracts/getting-started/ide-plugins)

### 2. Check the throw values

Each time the TVM execution stops normally, it stops with exit codes `0` or `1`. A contract can explicitly terminate with a successful exit by calling `throw(0)` or `throw(1)`.

- [How to handle errors](/v3/documentation/smart-contracts/func/docs/builtins#throwing-exceptions)
- [TVM exit codes](/v3/documentation/tvm/tvm-exit-codes)

### 3. FunC is a strictly typed language with data structures holding exactly what they are supposed to store

It is crucial to keep track of what the code does and what it may return. Keep in mind that the compiler cares only about the code and only in its initial state. After certain operations stored values of some variables can change.

Reading unexpected variable values and calling methods on data types that are not supposed to have such methods (or their return values are not stored properly) are errors and are not skipped as "warnings" or "notices" but lead to unreachable code. Keep in mind that storing an unexpected value may be okay, however, reading it may cause problems, e.g., error code 5 (integer out of expected range) may be thrown for an integer variable.

### 4. Messages have modes

It is essential to check the message mode, in particular its interaction with previous messages sent and fees. A possible failure is not accounting for storage fees, in which case the contract may run out of Toncoin, leading to unexpected failures when sending outgoing messages. You can view the message modes [here](/v3/documentation/smart-contracts/message-management/sending-messages#message-modes).

### 5. Replay protection \{#replay-protection}

There are two custom solutions for wallets (smart contracts that store user funds): `seqno-based` (using a counter to prevent processing the same message twice) and `high-load` (storing processed identifiers and their expiration times).

- [Seqno-based wallets](/v3/guidelines/dapps/asset-processing/payments-processing/#seqno-based-wallets)
- [High-load wallets](/v3/guidelines/dapps/asset-processing/payments-processing/#high-load-wallets)

For `seqno`, refer to [this section](/v3/documentation/smart-contracts/message-management/sending-messages#mode3) for details on possible replay scenarios.

### 6. TON fully implements the actor model

The code of a contract can be updated. It can be changed permanently using [`SETCODE`](/v3/documentation/smart-contracts/func/docs/stdlib#set_code) or updated at runtime using `set_c3` until the end of execution.

### 7. TON Blockchain has several transaction phases: compute phase, action phase, including a bounce phase

The compute phase executes the code of smart contracts and only then the actions are performed (sending messages, code modification, changing libraries, and others). Unlike on Ethereum-based blockchains, a sent message may fail during the action phase while the compute phase still exits successfully; such a failure is reflected in the action phase result, not in the compute phase exit code.

- [Transactions and phases](/v3/documentation/tvm/tvm-overview#transactions-and-phases)

### 8. TON contracts are autonomous

Contracts in the blockchain can reside in separate shards, processed by another set of validators, meaning that developers cannot pull data from other contracts on demand. Thus, any communication is asynchronous and done by sending messages.

- [Sending messages from smart contract](/v3/documentation/smart-contracts/message-management/sending-messages)
- [Sending messages from DApp](/v3/guidelines/ton-connect/cookbook/ton-transfer)

### 9. TON does not include revert reason strings; outcomes are indicated by [exit codes](/v3/documentation/tvm/tvm-exit-codes)

It is helpful to think through the roadmap of exit codes for the code flow (and have it documented) before starting programming your TON smart contract.

### 10. FunC method IDs

They can be either set explicitly `method_id(5)`, or implicitly by the FunC compiler. In this case, they can be found among method declarations in the Fift assembly (.fif) file. Two of them are predefined: `recv_internal` = 0 (receiving messages inside the blockchain) and `recv_external` = -1 (receiving messages from outside).

### 11. TON address may not have any coins or code

Smart contract addresses on the TON Blockchain are deterministic and can be precomputed. Accounts have states: non-existent, uninitialized, active, or frozen. Uninitialized addresses may still hold a balance.

### 12. TON addresses have two standard representations

A full representation can either be "raw" (`workchain:address`) or "user-friendly". The latter is the one users encounter most often. It contains a tag byte (e.g., bounceable, testnet, checksum) and a workchain ID byte. For full definitions of user-friendly flags, refer to the Address formats page below.

- [Raw and user-friendly addresses](/v3/documentation/smart-contracts/addresses/address-formats)

### 13. Understand method visibility

FunC has no visibility specifiers (unlike Solidity); implement access control in message handlers and contract logic.

### 14. Keep an eye on fees before sending bounced messages

When returning bounced value provided by a user, subtract the corresponding fees and be explicit about message mode/flags to control fee charging and bounce behavior.

### 15. Monitor the callbacks and their failures

TON blockchain is asynchronous. That means messages do not necessarily arrive in order; e.g., when a failure notification of an action arrives, it should be handled properly.

### 16. Check the bounced flag when receiving internal messages

You may receive bounced messages (error notifications), which should be handled.

- [Handling of standard response messages](/v3/documentation/smart-contracts/message-management/internal-messages#handling-of-standard-response-messages)

## References

- [Original article](https://0xguard.com/things_to_focus_on_while_working_with_ton_blockchain) - _0xguard_

<Feedback />
