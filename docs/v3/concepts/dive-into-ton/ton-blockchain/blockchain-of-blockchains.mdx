import Feedback from '@site/src/components/Feedback';

# Blockchain of Blockchains

A **blockchain** is a chain of blocks, each containing information that all participants in the network can access and trust. Every block is securely linked to the previous one, and the entire chain is continuously replicated and synchronized across the network.

The following key properties characterize a blockchain:

- **Immutable** – once data is added, it cannot be modified or removed.
- **Decentralized** – no single authority governs the chain; it is maintained collectively by network participants.
- **Transparent** – all data is openly accessible, enabling anyone to verify the integrity and history of the chain.

## TON Blockchain

Building on these principles, TON Blockchain introduces its own _architecture design_.

Unlike traditional _single-chain systems_, TON uses a **multi-chain**, **sharded architecture** - think of it as a _well-structured city_.
- At the center is the **MasterChain**, like a city hall. It maintains the official records, including the city map, the list of districts, and the registry of those responsible for keeping everything running smoothly.
- Below it are **WorkChains**—the districts of the city, each with its own purpose and set of rules. One of these is the **BaseChain**, the central and busiest district, where most everyday activities take place.
- Each WorkChain is divided into **ShardChains**, which are like streets within a district, allowing activity to happen in parallel without traffic jams.
- And at the smallest level are **AccountChains**, the individual buildings where accounts reside, keeping track of their own local history of **transactions**, including every action or change that happens to that account.

All these levels work together: activity starts in the buildings **(accounts)**, flows through the streets **(shards)**, gets organized within districts **(WorkChains)**, and stays coordinated by the city hall **(the MasterChain)**.

This behavior follows the **actor model**, where each contract is an independent entity reacting to messages.

### The Lowest Level: AccountChain

A **chain** can be viewed as a sequence of transactions, such as `Tx1 → Tx2 → Tx3 → …`. When this transaction sequence pertains to a single account, it is specifically termed an **AccountChain**.

Since nodes processing these transactions periodically need to synchronize the smart contract state to achieve consensus, transactions are grouped into batches called **blocks**. For instance:

```text
[Tx1 → Tx2] → [Tx3 → Tx4 → Tx5] → [] → [Tx6]
```

Batching does not alter the underlying sequence. Each transaction has exactly one predecessor in the per-account chain; the next transaction, if any, follows in sequence. Batching simply organizes this sequence into manageable blocks for consensus purposes.

Additionally, each block can contain queues of incoming and outgoing messages. Incorporating these queues ensures that a block fully encapsulates all events and state changes relevant to the smart contract within the block period.

## Many AccountChains: Shards

Now let us consider many accounts. We can group multiple AccountChains together; such a group of AccountChains is called a **ShardChain**. In the same way, we can cut a ShardChain into **ShardChain blocks**, which aggregate blocks for individual AccountChains.

### Dynamic Splitting and Merging of ShardChains

Note that since a ShardChain consists of easily distinguished AccountChains, we can easily split it. That way, if we have one ShardChain that describes events that happen with one million accounts and there are too many transactions per second to be processed by a single node, we **split** that chain into two smaller ShardChains, with each chain accounting for half a million accounts and each processed on a separate subset of nodes.

Analogously, if some shards become underutilized, they can be **merged** into one shard.

There are two limiting cases: when the shard cannot be split further and when the shard contains all accounts.

Accounts can interact with each other by sending messages. A unique routing mechanism moves messages from outgoing queues to corresponding incoming queues and ensures:

1. All messages are delivered.
2. Messages from a specific account A to a specific account B are delivered in the same order they were sent. However, if multiple accounts are involved, the order of message delivery is not guaranteed.

:::info SIDE NOTE
An aggregation of AccountChains into shards is based on the bitwise representation of account addresses to make splitting and merging deterministic. For example, an address looks like `(shard prefix, account_id)`. That way, all accounts in the ShardChain will have the same binary prefix (for instance, all addresses will start with `0b00101`).
:::

## WorkChain

An aggregation of all shards, which contains all accounts that behave according to one set of rules, is called a WorkChain.

In TON, there can be many sets of rules, and thus, many WorkChains operate simultaneously and can interact with each other by sending messages cross-chain in the same way that accounts of one chain can interact with each other.

### WorkChain: A Blockchain With Your Own Rules

If you want to customize the rules for its ShardChains, you could create a **WorkChain**. For example, Hypothetical example: it is theoretically possible to create a WorkChain that supports EVM to run Solidity smart contracts, but this would be a complex undertaking due to the differences between TVM and EVM.

Theoretically, anyone in the community can propose their own WorkChain. However, building one is a complex task. Furthermore, it requires governance approval.

TON allows up to `2^32` WorkChains, each subdivided into up to `2^60` shards.

Currently, there are only two WorkChains in TON: MasterChain and BaseChain.

BaseChain is used for everyday transactions between actors; the MasterChain coordinates the network.

### MasterChain

There is a necessity for the synchronization of message routing and transaction execution. In other words, nodes in the network need a way to fix some point in a multichain state and reach a consensus about that state. In TON, a special chain called the **MasterChain** is used for that purpose. Blocks of the MasterChain contain additional information—such as the latest block hashes—about all other chains in the system, so any observer can unambiguously determine the state of the multichain system at a single MasterChain block.

## See also
- [Sharding in TON](/v3/concepts/dive-into-ton/ton-blockchain/sharding)
- [Blockchain structure](/v3/guidelines/dapps/transactions/foundations-of-blockchain#blockchain-structure)
- [Shards](/v3/documentation/smart-contracts/shards/shards-intro)

<Feedback />
