# TON 节点命令行标志

本文档介绍运行 TON 节点时可用的各种标志和选项。每个标记都有一个短名称、一个长名称、一个默认值（如适用）以及对其功能的描述。

## 一般选项

| 选项                                                   | 说明                                                                                                                                                                                                                       | 默认值                                             | 使用方法                                                                             |
| ---------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------- | -------------------------------------------------------------------------------- |
| `-v`, `--verbosity`                                  | 设置日志输出的冗长程度。                                                                                                                                                                                                             | `INFO` (2)                                      | `-v <level>` (e.g., `-v 2`)                                                      |
| `-V`, `--version`                                    | 显示验证引擎的构建信息。                                                                                                                                                                                                             | N/A                                             | `-V`                                                                             |
| `-h`, `--help`                                       | 打印帮助信息。                                                                                                                                                                                                                  | N/A                                             | `-h`                                                                             |
| `-C`, `--global-config`                              | 指定读取全局配置（引导节点、公共 liteservers、初始块等）的文件。                                                                                                                                                                                   | N/A                                             | `-C <file>`                                                                      |
| `-c`, `--local-config`                               | 指定用于写入/读取本地节点配置（地址、密钥等）的文件。                                                                                                                                                                                              | N/A                                             | `-c <file>`                                                                      |
| `-I`, `--ip`                                         | 指定实例的 IP 地址和端口。首次运行时使用。                                                                                                                                                                                                  | N/A                                             | `-I <ip:port>`                                                                   |
| `-D`, `--db`                                         | 指定数据库的根目录。                                                                                                                                                                                                               | N/A                                             | `-D <path>`                                                                      |
| `-f`, `--fift-dir`                                   | 指定包含 Fift 脚本的目录。                                                                                                                                                                                                         | N/A                                             | `-f <path>`                                                                      |
| `-d`, `--daemonize`                                  | 通过关闭标准输入并创建新会话，对进程进行守护进程化。                                                                                                                                                                                               | Disabled                                        | `-d`                                                                             |
| `-l`, `--logname`                                    | 指定要写入日志的日志文件。                                                                                                                                                                                                            | N/A                                             | `-l <file>`                                                                      |
| `-s`, `--state-ttl`                                  | 设置状态的 TTL（生存时间），单位为秒。                                                                                                                                                                                                    | `86400` seconds (1 day)                         | `-s <seconds>`                                                                   |
| `-m`, `--mempool-num`                                | 指定 mempool 中外部信息的最大数量。                                                                                                                                                                                                   | Unlimited                                       | `-m <number>`                                                                    |
| `-b`, `--block-ttl`                                  | 设置块的 TTL，单位为秒。                                                                                                                                                                                                           | `86400` seconds (1 day)                         | `-b <seconds>`                                                                   |
| `-A`, `--archive-ttl`                                | 设置存档数据块的 TTL（秒）。                                                                                                                                                                                                         | `604800` seconds (7 days)                       | `-A <seconds>`                                                                   |
| `-K`, `--key-proof-ttl`                              | 以秒为单位设置密钥块的 TTL。                                                                                                                                                                                                         | `315360000` seconds (10 years)                  | `-K <seconds>`                                                                   |
| `-S`, `--sync-before`                                | 在初始同步期间，下载最后给定秒数内的所有数据块。                                                                                                                                                                                                 | `3600` seconds (1 hour)                         | `-S <seconds>`                                                                   |
| `-t`, `--threads`                                    | 指定要使用的线程数。                                                                                                                                                                                                               | `7`                                             | `-t <number>`                                                                    |
| `-u`, `--user`                                       | 更改运行进程的用户。                                                                                                                                                                                                               | N/A                                             | `-u <username>`                                                                  |

## 高级选项

| 选项                                                             | 说明                                                                                                                                                                                                           | 默认值                                             | 使用方法                                                                                     |
| -------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------- | ---------------------------------------------------------------------------------------- |
| `--shutdown-at`                                                | 计划验证器在给定的 Unix 时间戳关闭。                                                                                                                                                                                        | N/A                                             | `--shutdown-at <timestamp>`                                                              |
| `-T`, `--truncate-db`                                          | 以指定序列号作为新的顶级主链区块序列号，截断数据库。                                                                                                                                                                                   | N/A                                             | `-T <seqno>`                                                                             |
| `-U`, `--unsafe-catchain-restore`                              | 启用缓慢而危险的 catchain 恢复方法。                                                                                                                                                                                      | Disabled                                        | `-U <catchain-seqno>`                                                                    |
| `-F`, `--unsafe-catchain-rotate`                               | 启用强力和危险的连锁轮换。                                                                                                                                                                                                | Disabled                                        | `-F <block-seqno>:<catchain-seqno>:<height>`                                             |
| `--celldb-compress-depth`                                      | 将深度为 X 的 cell 与整个子树一起存储，从而优化 CellDb。                                                                                                                                                                         | `0` (disabled)                                  | `--celldb-compress-depth <depth>`                                                        |
| `--max-archive-fd`                                             | 设置归档管理器中打开文件描述符的数量限制。`0` 表示无限制。                                                                                                                                                                              | `0` (unlimited)                                 | `--max-archive-fd <number>`                                                              |
| `--archive-preload-period`                                     | 启动时预载过去 X 秒的存档片段。                                                                                                                                                                                            | `0` seconds (disabled)                          | `--archive-preload-period <seconds>`                                                     |
| `--enable-precompiled-smc`                                     | 可执行预编译智能合约（试验性）。                                                                                                                                                                                             | Disabled                                        | `--enable-precompiled-smc`                                                               |
| `--disable-rocksdb-stats`                                      | 禁止收集 RocksDb 统计数据。                                                                                                                                                                                           | Enabled                                         | `--disable-rocksdb-stats`                                                                |
| `--nonfinal-ls`                                                | 启用对非最终完成区块的特殊本地状态 (LS) 查询。                                                                                                                                                                                   | Disabled                                        | `--nonfinal-ls`                                                                          |
| `--celldb-cache-size`                                          | 设置 CellDb 中 RocksDb 的块缓存大小，单位为字节。                                                                                                                                                                            | `1G` (1 Gigabyte)                               | `--celldb-cache-size <size>`                                                             |
| `--celldb-direct-io`                                           | 为 CellDb 中的 RocksDb 启用直接 I/O 模式（仅当缓存大小 >= 30G 时适用）。                                                                                                                                                          | Disabled                                        | `--celldb-direct-io`                                                                     |
| `--celldb-preload-all`                                         | 启动时预载 CellDb 中的所有 cell 。                                                                                                                                                                                     | Disabled                                        | `--celldb-preload-all`                                                                   |
| `--celldb-in-memory`                                           | 在内存中存储整个 celldb。对于使用默认设置的验证器，cellldb 的大小约为 80-100GB，因此 128GB 是绝对必要的，最好是 256GB。                                                                                                                               | Disabled                                        | `--celldb-in-memory`                                                                     |
| `--catchain-max-block-delay`                                   | 设置创建新的 catchain 代码块前的延迟时间，单位为秒。                                                                                                                                                                              | `0.4` seconds                                   | `--catchain-max-block-delay <seconds>`                                                   |
| `--catchain-max-block-delay-slow`                              | 设置过长回合的最大扩展 catchain block 延迟（秒）。                                                                                                                                                                            | `1.0` seconds                                   | `--catchain-max-block-delay-slow <seconds>`                                              |
| `--fast-state-serializer`                                      | 可实现更快的持久状态序列化，但需要更多内存。                                                                                                                                                                                       | Disabled                                        | `--fast-state-serializer`                                                                |

## Session 日志选项

| 选项                                                   | 说明                                                                                                                                                                                                                   | 默认值                                                   | 使用方法                                                                   |
| ---------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------- | ---------------------------------------------------------------------- |
| `--session-logs`                                     | 指定验证程序会话统计的文件。                                                                                                                                                                                                       | `{logname}.session-stats`                             | `--session-logs <file>`                                                |
