---
description: –ü–æ –∏—Ç–æ–≥—É —É—Ä–æ–∫–∞ –≤—ã –Ω–∞–ø–∏—à–µ—Ç–µ –∫—Ä–∞—Å–∏–≤–æ–≥–æ –±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —Å–º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏ –∑–∞ –≤–∞—à —Ç–æ–≤–∞—Ä –ø—Ä—è–º–æ –≤ TON.
---

# –ë–æ—Ç –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ –ø–µ–ª—å–º–µ–Ω–µ–π

:::warning
–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫, –Ω–æ –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ —É–ª—É—á—à–µ–Ω–∏—è—Ö. –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–∏–Ω—è—Ç—å —É—á–∞—Å—Ç–∏–µ –≤ –ø–µ—Ä–µ–≤–æ–¥–µ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å [@alexgton](https://t.me/alexgton).
:::

–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –º—ã —Å–æ–∑–¥–∞–¥–∏–º –ø—Ä–æ—Å—Ç–æ–≥–æ Telegram-–±–æ—Ç–∞ –¥–ª—è –ø—Ä–∏–µ–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π –≤ TON.

## ü¶Ñ –ö–∞–∫ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç

–ü–æ –æ–∫–æ–Ω—á–∞–Ω–∏—é —É—Ä–æ–∫–∞ –≤—ã –Ω–∞–ø–∏—à–µ—Ç–µ –∫—Ä–∞—Å–∏–≤–æ–≥–æ –±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —Å–º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏ –∑–∞ –≤–∞—à —Ç–æ–≤–∞—Ä –ø—Ä—è–º–æ –≤ TON.

–ë–æ—Ç –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

![–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –±–æ—Ç–∞](/img/tutorials/js-bot-preview.jpg)

## üìñ –ß–µ–º—É –≤—ã –Ω–∞—É—á–∏—Ç–µ—Å—å

–í—ã —É–∑–Ω–∞–µ—Ç–µ, –∫–∞–∫:

- –°–æ–∑–¥–∞—Ç—å Telegram-–±–æ—Ç–∞ –≤ NodeJS —Å –ø–æ–º–æ—â—å—é grammY
- –†–∞–±–æ—Ç–∞—Ç—å —Å –æ—Ç–∫—Ä—ã—Ç—ã–º TON Center API

> –ü–æ—á–µ–º—É –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º grammY?
> –ü–æ—Ç–æ–º—É —á—Ç–æ grammY - —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π, –º–æ–ª–æ–¥–æ–π, –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —É–¥–æ–±–Ω–æ–π –∏ –±—ã—Å—Ç—Ä–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Telegram-–±–æ—Ç–æ–≤ –Ω–∞ JS/TS/Deno. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —É grammY –æ—Ç–ª–∏—á–Ω–∞—è [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è] (https://grammy.dev) –∏ –∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –≤—Å–µ–≥–¥–∞ —Å–º–æ–∂–µ—Ç –≤–∞–º –ø–æ–º–æ—á—å.

## ‚úçÔ∏è –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [NodeJS](https://nodejs.org/en/download/), –µ—Å–ª–∏ –≤—ã —ç—Ç–æ–≥–æ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–ª–∏.

–¢–∞–∫–∂–µ –≤–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è —ç—Ç–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

- grammy
- ton
- dotenv

–í—ã –º–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Ö –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.

```bash npm2yarn
npm install ton dotenv grammy @grammyjs/conversations
```

## üöÄ –î–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º!

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```
src
    ‚îú‚îÄ‚îÄ bot
        ‚îú‚îÄ‚îÄ start.js
        ‚îú‚îÄ‚îÄ payment.js
    ‚îú‚îÄ‚îÄ services 
        ‚îú‚îÄ‚îÄ ton.js
    ‚îú‚îÄ‚îÄ app.js
.env
```

- `bot/start.js` –∏ `bot/payment.js` - —Ñ–∞–π–ª—ã —Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏ –¥–ª—è Telegram-–±–æ—Ç–∞
- `src/ton.js` - —Ñ–∞–π–ª —Å business logic, —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å TON
- `app.js` - —Ñ–∞–π–ª –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º –ø–∏—Å–∞—Ç—å –∫–æ–¥!

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–î–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º —Å `.env`. –ù–∞–º –ø—Ä–æ—Å—Ç–æ –Ω—É–∂–Ω–æ –∑–∞–¥–∞—Ç—å –≤ –Ω–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

**.env**

```
BOT_TOKEN=
TONCENTER_TOKEN=
NETWORK=
OWNER_WALLET= 
```

–ó–¥–µ—Å—å –≤–∞–º –Ω—É–∂–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ø–µ—Ä–≤—ã—Ö —á–µ—Ç—ã—Ä–µ—Ö —Å—Ç—Ä–æ–∫–∞—Ö:

- `BOT_TOKEN` - —ç—Ç–æ –≤–∞—à —Ç–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ [—Å–æ–∑–¥–∞–Ω–∏—è –±–æ—Ç–∞] (https://t.me/BotFather).
- `OWNER_WALLET` - —ç—Ç–æ –∞–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –≤—Å–µ –ø–ª–∞—Ç–µ–∂–∏. –í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ—à–µ–ª–µ–∫ TON –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –∞–¥—Ä–µ—Å.
- `API_KEY` - —ç—Ç–æ –≤–∞—à API-–∫–ª—é—á –æ—Ç TON Center, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –æ—Ç [@tonapibot](https://t.me/tonapibot)/[@tontestnetapibot](https://t.me/tontestnetapibot) –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–π –∏ —Ç–µ—Å—Ç–æ–≤–æ–π —Å–µ—Ç–µ–π, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.
- `NETWORK` - —ç—Ç–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–º, –≤ –∫–∞–∫–æ–π —Å–µ—Ç–∏ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤–∞—à –±–æ—Ç - —Ç–µ—Å—Ç–æ–≤–æ–π –∏–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π.

–≠—Ç–æ –≤—Å–µ, —á—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, —Ç–∞–∫ —á—Ç–æ –º—ã –º–æ–∂–µ–º –¥–≤–∏–≥–∞—Ç—å—Å—è –¥–∞–ª—å—à–µ!

## TON Center API

–í —Ñ–∞–π–ª–µ `src/services/ton.py` –º—ã –±—É–¥–µ–º –¥–µ–∫–ª–∞—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Å—ã–ª–æ–∫ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –∫–æ—à–µ–ª—å–∫–∞ –¥–ª—è –æ–ø–ª–∞—Ç—ã

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ –∫–æ—à–µ–ª—å–∫—É

–ù–∞—à–∞ –∑–∞–¥–∞—á–∞ - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –Ω—É–∂–Ω–æ–π –Ω–∞–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∫–æ—à–µ–ª—å–∫–∞.

–ú—ã —Ä–µ—à–∏–º —ç—Ç—É –∑–∞–¥–∞—á—É —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

1. –ú—ã –ø–æ–ª—É—á–∏–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –ø–æ—Å—Ç—É–ø–∏–≤—à–∏–µ –Ω–∞ –Ω–∞—à –∫–æ—à–µ–ª–µ–∫. –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ –Ω–∞ –Ω–∞—à? –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –Ω–∞–º –Ω–µ –Ω—É–∂–Ω–æ –±–µ—Å–ø–æ–∫–æ–∏—Ç—å—Å—è –æ–± –∞–¥—Ä–µ—Å–µ –∫–æ—à–µ–ª—å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–∞–º –Ω–µ –Ω—É–∂–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—Ç—å, —á—Ç–æ —ç—Ç–æ –µ–≥–æ –∫–æ—à–µ–ª–µ–∫, –Ω–∞–º –Ω–µ –Ω—É–∂–Ω–æ –Ω–∏–≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å —ç—Ç–æ—Ç –∫–æ—à–µ–ª–µ–∫ –≥–¥–µ-–ª–∏–±–æ.
2. –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∏ –æ—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–ª—å–∫–æ –≤—Ö–æ–¥—è—â–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
3. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–π–¥–µ–º—Å—è –ø–æ –≤—Å–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º, –∏ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –±—É–¥–µ–º –ø—Ä–æ–≤–µ—Ä—è—Ç—å, —Ä–∞–≤–Ω—ã –ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏ —Å—É–º–º–∞ —Ç–µ–º –¥–∞–Ω–Ω—ã–º, –∫–æ—Ç–æ—Ä—ã–µ —É –Ω–∞—Å –µ—Å—Ç—å
4. –ü—Ä–∞–∑–¥–Ω—É–µ–º —Ä–µ—à–µ–Ω–∏–µ –Ω–∞—à–µ–π –ø—Ä–æ–±–ª–µ–º—ãüéâ

#### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

–ï—Å–ª–∏ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º TON Center API, —Ç–æ –º—ã –º–æ–∂–µ–º –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –∏—Ö [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](https://toncenter.com/api/v2/) –∏ –Ω–∞–π—Ç–∏ –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∏–¥–µ–∞–ª—å–Ω–æ —Ä–µ—à–∞–µ—Ç –Ω–∞—à—É –ø—Ä–æ–±–ª–µ–º—É - [getTransactions](https://toncenter.com/api/v2/#/accounts/get_transactions_getTransactions_get).

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –Ω–∞–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–¥–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ - –∞–¥—Ä–µ—Å–∞ –∫–æ—à–µ–ª—å–∫–∞ –¥–ª—è –ø—Ä–∏–µ–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π, –Ω–æ –º—ã —Ç–∞–∫–∂–µ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä limit, —á—Ç–æ–±—ã –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –≤—ã–¥–∞—á—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–æ 100 —à—Ç—É–∫.

–î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º –≤—ã–∑–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –∞–¥—Ä–µ—Å–∞ `EQCD39VS5jcptHL8vMjEXrzGaRcCVYto7HUn4bpAOg8xqB2N` (–∫—Å—Ç–∞—Ç–∏, —ç—Ç–æ –∞–¥—Ä–µ—Å TON Foundation)

```bash
curl -X 'GET' \
  'https://toncenter.com/api/v2/getTransactions?address=EQCD39VS5jcptHL8vMjEXrzGaRcCVYto7HUn4bpAOg8xqB2N&limit=100' \
  -H 'accept: application/json'
```

–û—Ç–ª–∏—á–Ω–æ, —Ç–µ–ø–µ—Ä—å —É –Ω–∞—Å –µ—Å—Ç—å —Å–ø–∏—Å–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ ["result"], —Ç–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø–æ–¥—Ä–æ–±–Ω–µ–µ 1 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é

```json
{
      "@type": "raw.transaction",
      "utime": 1667148685,
      "data": "*data here*",
      "transaction_id": {
        "@type": "internal.transactionId",
        "lt": "32450206000003",
        "hash": "rBHOq/T3SoqWta8IXL8THxYqTi2tOkBB8+9NK0uKWok="
      },
      "fee": "106508",
      "storage_fee": "6508",
      "other_fee": "100000",
      "in_msg": {
        "@type": "raw.message",
        "source": "EQA0i8-CdGnF_DhUHHf92R1ONH6sIA9vLZ_WLcCIhfBBXwtG",
        "destination": "EQCD39VS5jcptHL8vMjEXrzGaRcCVYto7HUn4bpAOg8xqB2N",
        "value": "1000000",
        "fwd_fee": "666672",
        "ihr_fee": "0",
        "created_lt": "32450206000002",
        "body_hash": "Fl+2CzHNgilBE4RKhfysLU8VL8ZxYWciCRDva2E19QQ=",
        "msg_data": {
          "@type": "msg.dataText",
          "text": "aGVsbG8g8J+Riw=="
        },
        "message": "hello üëã"
      },
      "out_msgs": []
    }
```

–ò–∑ —ç—Ç–æ–≥–æ json-—Ñ–∞–π–ª–∞ –º—ã –º–æ–∂–µ–º –ø–æ–Ω—è—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∞–º –ø–æ–ª–µ–∑–Ω–∞:

- –≠—Ç–æ –≤—Ö–æ–¥—è—â–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è, –ø–æ—Å–∫–æ–ª—å–∫—É –ø–æ–ª–µ "out_msgs" –ø—É—Å—Ç–æ–µ.
- –ú—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –µ–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—é –∏ —Å—É–º–º–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.

–¢–µ–ø–µ—Ä—å –º—ã –≥–æ—Ç–æ–≤—ã —Å–æ–∑–¥–∞—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

### –†–∞–±–æ—Ç–∞ —Å TON

–î–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º —Å –∏–º–ø–æ—Ä—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ TON

```js
import { HttpApi, fromNano, toNano } from "ton";
```

–î–∞–≤–∞–π—Ç–µ –ø–æ–¥—É–º–∞–µ–º, –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –æ—Ç–ø—Ä–∞–≤–∏–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω—É–∂–Ω—É—é –Ω–∞–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é.

–í—Å–µ —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–æ –ø—Ä–æ—Å—Ç–æ. –ú—ã –º–æ–∂–µ–º –ø—Ä–æ—Å—Ç–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤—Ö–æ–¥—è—â–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –Ω–∞—à –∫–æ—à–µ–ª–µ–∫, –∞ –∑–∞—Ç–µ–º –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –∏ –µ—Å–ª–∏ –Ω–∞–π–¥–µ—Ç—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å —Ç–∞–∫–∏–º –∂–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º –∏ —Å—É–º–º–æ–π, –∑–Ω–∞—á–∏—Ç, –º—ã –Ω–∞—à–ª–∏ –Ω—É–∂–Ω—É—é –Ω–∞–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é!

–î–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º —Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ http-–∫–ª–∏–µ–Ω—Ç–∞, –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã —Å TON

```js
export async function verifyTransactionExistance(toWallet, amount, comment) {
  const endpoint =
    process.env.NETWORK === "mainnet"
      ? "https://toncenter.com/api/v2/jsonRPC"
      : "https://testnet.toncenter.com/api/v2/jsonRPC";
  const httpClient = new HttpApi(
    endpoint,
    {},
    { apiKey: process.env.TONCENTER_TOKEN }
  );
```

–ó–¥–µ—Å—å –º—ã –ø—Ä–æ—Å—Ç–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º url –∫–æ–Ω–µ—á–Ω–æ–π —Ç–æ—á–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫–∞—è —Å–µ—Ç—å –≤—ã–±—Ä–∞–Ω–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º http-–∫–ª–∏–µ–Ω—Ç.

–ò—Ç–∞–∫, —Ç–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏–∑ –∫–æ—à–µ–ª—å–∫–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞

```js
const transactions = await httpClient.getTransactions(toWallet, {
    limit: 100,
  });
```

–∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ, –æ—Å—Ç–∞–≤–∏–≤ —Ç–æ–ª—å–∫–æ –≤—Ö–æ–¥—è—â–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–µ—Å–ª–∏ out_msgs —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—É—Å—Ç, –º—ã –æ—Å—Ç–∞–≤–ª—è–µ–º –µ–≥–æ)

```js
let incomingTransactions = transactions.filter(
    (tx) => Object.keys(tx.out_msgs).length === 0
  );
```

–¢–µ–ø–µ—Ä—å –Ω–∞–º –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–æ–π—Ç–∏—Å—å –ø–æ –≤—Å–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º, –∏ –µ—Å–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç, –º—ã –≤–µ—Ä–Ω–µ–º true

```js
  for (let i = 0; i < incomingTransactions.length; i++) {
    let tx = incomingTransactions[i];
    // Skip the transaction if there is no comment in it
    if (!tx.in_msg.msg_data.text) {
      continue;
    }

    // Convert transaction value from nano
    let txValue = fromNano(tx.in_msg.value);
    // Get transaction comment
    let txComment = tx.in_msg.message

    if (txComment === comment && txValue === value.toString()) {
      return true;
    }
  }

  return false;
```

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∞–µ—Ç—Å—è –≤ –Ω–∞–Ω–æ—Ç–æ–Ω–∞—Ö, –ø–æ—ç—Ç–æ–º—É –Ω–∞–º –Ω—É–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –µ–≥–æ –Ω–∞ 1 –º–∏–ª–ª–∏–∞—Ä–¥, –∏–ª–∏ –∂–µ –º—ã –º–æ–∂–µ–º –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ `fromNano` –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ TON.
–í–æ—Ç –∏ –≤—Å–µ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ `verifyTransactionExistance`!

–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Å—ã–ª–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –∫–æ—à–µ–ª—å–∫–∞ –¥–ª—è –æ–ø–ª–∞—Ç—ã

```js
export function generatePaymentLink(toWallet, amount, comment, app) {
  if (app === "tonhub") {
    return `https://tonhub.com/transfer/${toWallet}?amount=${toNano(
      amount
    )}&text=${comment}`;
  }
  return `https://app.tonkeeper.com/transfer/${toWallet}?amount=${toNano(
    amount
  )}&text=${comment}`;
}
```

–í—Å–µ, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ - —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ URL. –ù–µ –∑–∞–±—ã–≤ –ø—Ä–∏ —ç—Ç–æ–º –ø–µ—Ä–µ–¥–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ nano.

## Telegram-–±–æ—Ç

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `app.js` –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –Ω–∞–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏ –º–æ–¥—É–ª–∏.

```js
import dotenv from "dotenv";
import { Bot, session } from "grammy";
import { conversations, createConversation } from "@grammyjs/conversations";

import {
  startPaymentProcess,
  checkTransaction,
} from "./bot/handlers/payment.js";
import handleStart from "./bot/handlers/start.js";
```

–î–∞–≤–∞–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏–º –º–æ–¥—É–ª—å dotenv –¥–ª—è —É–¥–æ–±–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –∑–∞–¥–∞–ª–∏ –≤ —Ñ–∞–π–ª–µ .env

```js
dotenv.config();
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã —Å–æ–∑–¥–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–∞—à –ø—Ä–æ–µ–∫—Ç. –ß—Ç–æ–±—ã –Ω–∞—à –±–æ—Ç –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è –ø—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–æ–∫, –º—ã –¥–æ–±–∞–≤–ª—è–µ–º —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥

```js
async function runApp() {
  console.log("Starting app...");

  // Handler of all errors, in order to prevent the bot from stopping
  process.on("uncaughtException", function (exception) {
    console.log(exception);
  });
```

–¢–µ–ø–µ—Ä—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –±–æ—Ç–∞ –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–ª–∞–≥–∏–Ω—ã

```js
  // Initialize the bot
  const bot = new Bot(process.env.BOT_TOKEN);

  // Set the initial data of our session
  bot.use(session({ initial: () => ({ amount: 0, comment: "" }) }));
  // Install the conversation plugin
  bot.use(conversations());

  bot.use(createConversation(startPaymentProcess));
```

–ó–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º `BOT_TOKEN` –∏–∑ –Ω–∞—à–µ–≥–æ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –º—ã —Å–¥–µ–ª–∞–ª–∏ –≤ –Ω–∞—á–∞–ª–µ —É—Ä–æ–∫–∞.

–ú—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏ –±–æ—Ç–∞, –Ω–æ –æ–Ω –≤—Å–µ –µ—â–µ –ø—É—Å—Ç. –ú—ã –¥–æ–ª–∂–Ω—ã –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.

```js
  // Register all handelrs
  bot.command("start", handleStart);
  bot.callbackQuery("buy", async (ctx) => {
    await ctx.conversation.enter("startPaymentProcess");
  });
  bot.callbackQuery("check_transaction", checkTransaction);
```

–í –æ—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—É /start, –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è handleStart. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–º–µ—Ç –Ω–∞ –∫–Ω–æ–ø–∫—É —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º callback_data, —Ä–∞–≤–Ω—ã–º "buy", –º—ã –Ω–∞—á–Ω–µ–º –Ω–∞—à "conversation", –∫–æ—Ç–æ—Ä—ã–π –º—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏ —á—É—Ç—å –≤—ã—à–µ. –ê –∫–æ–≥–¥–∞ –º—ã –Ω–∞–∂–º–µ–º –Ω–∞ –∫–Ω–æ–ø–∫—É —Å callback_data, —Ä–∞–≤–Ω—ã–º "check_transaction", –º—ã –≤—ã–ø–æ–ª–Ω–∏–º —Ñ—É–Ω–∫—Ü–∏—é checkTransaction.

–ò –≤—Å–µ, —á—Ç–æ –Ω–∞–º –æ—Å—Ç–∞–µ—Ç—Å—è, —ç—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞ –∏ –≤—ã–≤–µ—Å—Ç–∏ –∂—É—Ä–Ω–∞–ª –æ–± —É—Å–ø–µ—à–Ω–æ–º –∑–∞–ø—É—Å–∫–µ

```js
  // Start bot
  await bot.init();
  bot.start();
  console.info(`Bot @${bot.botInfo.username} is up and running`);
```

### –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

#### –ö–æ–º–∞–Ω–¥–∞ /start

–î–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º —Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã `/start`. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å—Ç–∏—Ç –±–æ—Ç–∞ –≤ –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç –µ–≥–æ

```js
import { InlineKeyboard } from "grammy";

export default async function handleStart(ctx) {
  const menu = new InlineKeyboard()
    .text("Buy dumplingsü•ü", "buy")
    .row()
    .url("Article with a detailed explanation of the bot's work", "docs.ton.org/v3/guidelines/dapps/tutorials/telegram-bot-examples/accept-payments-in-a-telegram-bot-js");

  await ctx.reply(
    `Hello stranger!
Welcome to the best Dumplings Shop in the world <tg-spoiler>and concurrently an example of accepting payments in TON</tg-spoiler>`,
    { reply_markup: menu, parse_mode: "HTML" }
  );
}
```

–ó–¥–µ—Å—å –º—ã —Å–Ω–∞—á–∞–ª–∞ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º InlineKeyboard –∏–∑ –º–æ–¥—É–ª—è grammy. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã —Å–æ–∑–¥–∞–µ–º –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –∫—É–ø–∏—Ç—å –ø–µ–ª—å–º–µ–Ω–∏ –∏ —Å—Å—ã–ª–∫–æ–π –Ω–∞ —ç—Ç—É —Å—Ç–∞—Ç—å—é (–∑–¥–µ—Å—å –Ω–µ–º–Ω–æ–≥–æ —Ä–µ–∫—É—Ä—Å–∏–∏üòÅ).
.row() - –æ–∑–Ω–∞—á–∞–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å —Å–ª–µ–¥—É—é—â–µ–π –∫–Ω–æ–ø–∫–∏ –Ω–∞ –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É.
–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–µ–∫—Å—Ç–æ–º (–≤–∞–∂–Ω–æ - —è –∏—Å–ø–æ–ª—å–∑—É—é html-—Ä–∞–∑–º–µ—Ç–∫—É –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏, —á—Ç–æ–±—ã —É–∫—Ä–∞—Å–∏—Ç—å –µ–≥–æ) –≤–º–µ—Å—Ç–µ —Å —Å–æ–∑–¥–∞–Ω–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π.
–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±—ã–º, –∫–∞–∫–∏–º –≤—ã –∑–∞—Ö–æ—Ç–∏—Ç–µ.

#### –ü—Ä–æ—Ü–µ—Å—Å –æ–ø–ª–∞—Ç—ã

–ö–∞–∫ –æ–±—ã—á–Ω–æ, –º—ã –Ω–∞—á–Ω–µ–º –Ω–∞—à —Ñ–∞–π–ª —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤

```js
import { InlineKeyboard } from "grammy";

import {
  generatePaymentLink,
  verifyTransactionExistance,
} from "../../services/ton.js";
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã —Å–æ–∑–¥–∞–¥–∏–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ startPaymentProcess, –∫–æ—Ç–æ—Ä—ã–π –º—ã —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏ –≤ app.js –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –∫–Ω–æ–ø–∫–∏

–í Telegram –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫—É –ø–æ—è–≤–ª—è—é—Ç—Å—è –∫—Ä—É—Ç—è—â–∏–µ—Å—è —á–∞—Å—ã, —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å –∏—Ö, –º—ã –æ—Ç–≤–µ—Ç –Ω–∞ callback-–∑–∞–ø—Ä–æ—Å

```js
  await ctx.answerCallbackQuery();
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–∞–º –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∫–∞—Ä—Ç–∏–Ω–∫—É —Å –ø–µ–ª—å–º–µ–Ω—è–º–∏, –ø–æ–ø—Ä–æ—Å–∏—Ç—å –µ–≥–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ–ª—å–º–µ–Ω–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω —Ö–æ—á–µ—Ç –∫—É–ø–∏—Ç—å. –ò –¥–æ–∂–¥–∞—Ç—å—Å—è, –ø–æ–∫–∞ –æ–Ω –≤–≤–µ–¥–µ—Ç —á–∏—Å–ª–æ.

```js
  await ctx.replyWithPhoto(
    "https://telegra.ph/file/bad2fd69547432e16356f.jpg",
    {
      caption:
        "Send the number of portions of yummy dumplings you want buy\nP.S. Current price for 1 portion: 3 TON",
    }
  );

  // Wait until the user enters the number
  const count = await conversation.form.number();
```

–¢–µ–ø–µ—Ä—å –º—ã –ø–æ–¥—Å—á–∏—Ç–∞–µ–º –æ–±—â—É—é —Å—É–º–º—É –∑–∞–∫–∞–∑–∞ –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—É—é —Å—Ç—Ä–æ–∫—É, –∫–æ—Ç–æ—Ä—É—é –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ—Å—Ç—Ñ–∏–∫—Å–∞ –ø–µ–ª—å–º–µ–Ω–µ–π

```js
  // Get the total cost: multiply the number of portions by the price of the 1 portion
  const amount = count * 3;
  // Generate random comment
  const comment = Math.random().toString(36).substring(2, 8) + "dumplings";
```

–ò —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å–µ—Å—Å–∏–∏, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º –ø–æ–ª—É—á–∏—Ç—å –∏—Ö –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ.

```js
  conversation.session.amount = amount;
  conversation.session.comment = comment;
```

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å—Å—ã–ª–∫–∏ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –±—ã—Å—Ç—Ä–æ–π –æ–ø–ª–∞—Ç–µ –∏ —Å–æ–∑–¥–∞–µ–º –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É

```js
const tonhubPaymentLink = generatePaymentLink(
    process.env.OWNER_WALLET,
    amount,
    comment,
    "tonhub"
  );
  const tonkeeperPaymentLink = generatePaymentLink(
    process.env.OWNER_WALLET,
    amount,
    comment,
    "tonkeeper"
  );

  const menu = new InlineKeyboard()
    .url("Click to pay in TonHub", tonhubPaymentLink)
    .row()
    .url("Click to pay in Tonkeeper", tonkeeperPaymentLink)
    .row()
    .text(`I sent ${amount} TON`, "check_transaction");
```

–ò –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã, –≥–¥–µ –º—ã –ø—Ä–æ—Å–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –Ω–∞ –∞–¥—Ä–µ—Å –Ω–∞—à–µ–≥–æ –∫–æ—à–µ–ª—å–∫–∞ —Å–æ —Å–ª—É—á–∞–π–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º

```js
  await ctx.reply(
    `
Fine, all you have to do is transfer ${amount} TON to the wallet <code>${process.env.OWNER_WALLET}</code> with the comment <code>${comment}</code>.

<i>WARNING: I am currently working on ${process.env.NETWORK}</i>

P.S. You can conveniently make a transfer by clicking on the appropriate button below and confirm the transaction in the offer`,
    { reply_markup: menu, parse_mode: "HTML" }
  );
}
```

–¢–µ–ø–µ—Ä—å –Ω–∞–º –æ—Å—Ç–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

```js
export async function checkTransaction(ctx) {
  await ctx.answerCallbackQuery({
    text: "Wait a bit, I need to check the availability of your transaction",
  });

  if (
    await verifyTransactionExistance(
      process.env.OWNER_WALLET,
      ctx.session.amount,
      ctx.session.comment
    )
  ) {
    const menu = new InlineKeyboard().text("Buy more dumplingsü•ü", "buy");

    await ctx.reply("Thank you so much. Enjoy your meal!", {
      reply_markup: menu,
    });

    // Reset the session data
    ctx.session.amount = 0;
    ctx.session.comment = "";
  } else {
    await ctx.reply("I didn't receive your transaction, wait a bit");
  }
}
```

–í—Å–µ, —á—Ç–æ –∑–¥–µ—Å—å –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –∏ –µ—Å–ª–∏ –æ–Ω–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –º—ã —Å–æ–æ–±—â–∞–µ–º –æ–± —ç—Ç–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Å–µ—Å—Å–∏–∏

### –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç—É –∫–æ–º–∞–Ω–¥—É:

```bash npm2yarn
npm run app
```

–ï—Å–ª–∏ –≤–∞—à –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, —Å—Ä–∞–≤–Ω–∏—Ç–µ —Å–≤–æ–π –∫–æ–¥ —Å –∫–æ–¥–æ–º [–∏–∑ —ç—Ç–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è](https://github.com/coalus/DumplingShopBot). –ï—Å–ª–∏ —ç—Ç–æ –Ω–µ –ø–æ–º–æ–≥–ª–æ, –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –Ω–∞–ø–∏—Å–∞—Ç—å –º–Ω–µ –≤ Telegram. –ú–æ–π –∞–∫–∫–∞—É–Ω—Ç –≤ Telegram –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –Ω–∏–∂–µ

## –°—Å—ã–ª–∫–∏

- –°–¥–µ–ª–∞–Ω–æ –¥–ª—è TON –∫–∞–∫ —á–∞—Å—Ç—å [ton-footsteps/58] (https://github.com/ton-society/ton-footsteps/issues/58)
- By Coalus ([Telegram @coalus](https://t.me/coalus), [Coalus –Ω–∞ GitHub](https://github.com/coalus))
- [–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –±–æ—Ç–æ–≤](https://github.com/coalus/DumplingShopBot)
