import Feedback from '@site/src/components/Feedback';

import ConceptImage from '@site/src/components/conceptImage'

# Тестирование мини-приложений

## Использование ботов в тестовой среде разработки

Чтобы войти в тестовую среду, воспользуйтесь одним из следующих способов:

* **iOS:** нажмите 10 раз на значок Настройки > Учетные записи > Вход в другую учетную запись > Тест. Navigate to > Accounts > Login to another account > Test.
* **Telegram Desktop:** откройте ☰ Настройки > Shift + Alt + щелкните правой кнопкой мыши на 'Add Account' и выберите 'Test Server'.
* **macOS:** нажмите 10 раз на значок "Настройки", чтобы открыть меню отладки, ⌘ + нажмите "Добавить учетную запись" и войдите в систему по номеру телефона. `⌘` + Click **Add Account** and log in using your phone number.

Тестовая среда полностью отделена от основной. Вам нужно будет создать **новый аккаунт пользователя** и **нового бота**, используя `@BotFather`.

После получения токена бота, отправляйте запросы в Bot API в следующем формате:

`https://api.telegram.org/bot<token>/test/METHOD_NAME`

**Примечание:** При работе с тестовой средой вы можете использовать HTTP-ссылки без TLS для тестирования Вашего мини-приложения.

## Режим отладки для мини-приложений

Используйте следующие инструменты для выявления проблем, связанных с вашими мини-приложениями:

### Android

* [Включить USB-отладку](https://developer.chrome.com/docs/devtools/remote-debugging/) на Вашем устройстве.
* В настройках Telegram прокрутите страницу до конца вниз, нажмите  **номер версии** два раза и удерживайте.
* Выберите *Включить отладку WebView* в настройках отладки.
* Подключите телефон к компьютеру и откройте chrome://inspect/#devices в Chrome - вы увидите там ваше мини-приложение, когда запустите его на телефоне.
* Launch your Mini App on your phone, and it will appear in Chrome’s Inspect Devices tab.

### iOS

Для отладки iOS webview требуется десктопный браузер Safari и macOS.

**На устройстве iOS:**

* Перейдите в раздел *Настройки*.
* Найдите значок Safari и нажмите на него.
* Прокрутите вниз и нажмите *Дополнительно*.
* Включите опцию *Веб-инспектор*.

**На macOS:**

* Откройте браузер Safari.
* Откройте *Настройки* (⌘ + ,).
* Выберите вкладку *Дополнительно*.
* Check *Show features for web developers*.

**Следующие шаги:**

* Подключите iOS-устройство к Mac с помощью кабеля.
* Откройте мини-приложение в клиенте Telegram для iOS.
* Откройте вкладку *Разработка* в строке меню в Safari на macOS.
* Выберите подключенный iPhone.
* Опционально: выберите *Подключение по сети* и отсоедините кабель.
* Выберите открытый URL-адрес webview в блоке *Telegram*.

### Telegram Desktop в Windows, Linux и macOS

* Загрузите и запустите последнюю версию Telegram Desktop на **Windows**, **Linux** или **macOS** (на момент написания этой статьи доступна версия 5.0.1).
* Перейдите в *Настройки > Дополнительно > Экспериментальные настройки > Включить проверку webview*.
* В Windows и Linux щелкните правой кнопкой мыши на WebView и выберите *Проверить (Inspect)*.
* На macOS Вам необходимо получить доступ к Inspect через [Меню Разработчика Safari](https://support.apple.com/en-gb/guide/safari/sfri20948/mac)
  , а функция Inspect недоступна через контекстное меню, вызываемое правой кнопки мыши.

### Telegram macOS

* Скачайте и запустите [Бета-версию](https://telegram.org/dl/macos/beta) Telegram macOS.
* Быстро нажмите 5 раз на значок "Настройки", чтобы открыть меню отладки и включить "Отладку мини-приложений".

Щелкните правой кнопкой мыши в мини-приложении и выберите *Inspect Element*.

## Тестирование с Eruda

[Eruda](https://github.com/liriliri/eruda) - это инструмент, предоставляющий веб-консоль для отладки и проверки веб-страниц на мобильных устройствах и в десктопных браузерах.

![1](/img/docs/telegram-apps/eruda-1.png)

### Шаг 1: Включите библиотеку Eruda

Для начала добавьте библиотеку Eruda в свой HTML-файл.

**Option 1:** use a CDN (recommended).

```html
<!-- Include Eruda from CDN (Recommended) -->
<script src="https://cdn.jsdelivr.net/npm/eruda"></script>
```

**Option 2:** install via npm.

```bash npm2yarn
npm install eruda --save
```

### Шаг 2: Инициализируйте Eruda

Затем инициализируйте Eruda при загрузке веб-страницы. Если Вы используете Eruda с CDN, сделайте следующее:

```html
<script src="https://cdn.jsdelivr.net/npm/eruda"></script>
<script>
  // Initialize Eruda
  eruda.init();
</script>

```

Если Вы предпочитаете последние версии инструментов и пакетов, добавьте этот скрипт в свой проект:

```jsx
import eruda from 'eruda'

eruda.init()
```

### Шаг 3: Запустите Eruda

After deploying your Mini App:

* Open it in Telegram.
* После развертывания вашего мини-приложения запустите его и просто нажмите на значок Eruda, чтобы начать отладку!

<ConceptImage style={{maxWidth:'200pt', margin: '10pt 20pt 0 0', display: 'flex-box'}} src="/img/docs/telegram-apps/eruda-2.png" />

<ConceptImage style={{maxWidth:'200pt', margin: '10pt 20pt', display: 'flex-box'}} src="/img/docs/telegram-apps/eruda-3.png" />

<Feedback />
