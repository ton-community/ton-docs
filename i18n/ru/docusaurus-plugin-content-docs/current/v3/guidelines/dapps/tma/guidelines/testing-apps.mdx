import ConceptImage from '@site/src/components/conceptImage'

# Тестирование мини-приложений

:::warning
Эта страница переведена сообществом на русский язык, но нуждается в улучшениях. Если вы хотите принять участие в переводе свяжитесь с [@alexgton](https://t.me/alexgton).
:::

## Использование ботов в тестовой среде разработки

Чтобы войти в тестовую среду, воспользуйтесь одним из следующих способов:

- **iOS:** нажмите 10 раз на значок Настройки > Учетные записи > Вход в другую учетную запись > Тест.
- **Telegram Desktop:** откройте ☰ Настройки > Shift + Alt + щелкните правой кнопкой мыши на 'Add Account' и выберите 'Test Server'.
- **macOS:** нажмите 10 раз на значок "Настройки", чтобы открыть меню отладки, ⌘ + нажмите "Добавить учетную запись" и войдите в систему по номеру телефона.

Тестовая среда полностью отделена от основной. Вам нужно будет создать **новый аккаунт пользователя** и **нового бота**, используя `@BotFather`.

После получения токена бота, отправляйте запросы в Bot API в следующем формате:

`https://api.telegram.org/bot<token>/test/METHOD_NAME`

**Примечание:** При работе с тестовой средой вы можете использовать HTTP-ссылки без TLS для тестирования Вашего мини-приложения.

## Режим отладки для мини-приложений

Используйте следующие инструменты для выявления проблем, связанных с вашими мини-приложениями:

### Android

- [Включить USB-отладку](https://developer.chrome.com/docs/devtools/remote-debugging/) на Вашем устройстве.
- В настройках Telegram прокрутите страницу до конца вниз, нажмите  **номер версии** два раза и удерживайте.
- Выберите _Включить отладку WebView_ в настройках отладки.
- Подключите телефон к компьютеру и откройте chrome://inspect/#devices в Chrome - вы увидите там ваше мини-приложение, когда запустите его на телефоне.

### iOS

Для отладки iOS webview требуется десктопный браузер Safari и macOS.

**На устройстве iOS:**

- Перейдите в раздел _Настройки_.
- Найдите значок Safari и нажмите на него.
- Прокрутите вниз и нажмите _Дополнительно_.
- Включите опцию _Веб-инспектор_.

**На macOS:**

- Откройте браузер Safari.
- Откройте _Настройки_ (⌘ + ,).
- Выберите вкладку _Дополнительно_.
- Отметьте внизу опцию _Показать возможности для веб-разработчиков_.

**Следующие шаги:**

- Подключите iOS-устройство к Mac с помощью кабеля.
- Откройте мини-приложение в клиенте Telegram для iOS.
- Откройте вкладку _Разработка_ в строке меню в Safari на macOS.
- Выберите подключенный iPhone.
- Опционально: выберите _Подключение по сети_ и отсоедините кабель.
- Выберите открытый URL-адрес webview в блоке _Telegram_.

### Telegram Desktop в Windows, Linux и macOS

- Загрузите и запустите последнюю версию Telegram Desktop на **Windows**, **Linux** или **macOS** (на момент написания этой статьи доступна версия 5.0.1).
- Перейдите в _Настройки > Дополнительно > Экспериментальные настройки > Включить проверку webview_.
- В Windows и Linux щелкните правой кнопкой мыши на WebView и выберите _Проверить (Inspect)_.
- На macOS Вам необходимо получить доступ к Inspect через [Меню Разработчика Safari](https://support.apple.com/en-gb/guide/safari/sfri20948/mac)
  , а функция Inspect недоступна через контекстное меню, вызываемое правой кнопки мыши.

### Telegram macOS

- Скачайте и запустите [Бета-версию](https://telegram.org/dl/macos/beta) Telegram macOS.
- Быстро нажмите 5 раз на значок "Настройки", чтобы открыть меню отладки и включить "Отладку мини-приложений".

Щелкните правой кнопкой мыши в мини-приложении и выберите _Inspect Element_.

## Тестирование с Eruda

[Eruda](https://github.com/liriliri/eruda) - это инструмент, предоставляющий веб-консоль для отладки и проверки веб-страниц на мобильных устройствах и в десктопных браузерах. Вот пошаговое руководство по использованию Eruda в проектах мини-приложений Telegram.

![1](/img/docs/telegram-apps/eruda-1.png)

### Шаг 1: Включите библиотеку Eruda

Для начала добавьте библиотеку Eruda в свой HTML-файл. Вы можете загрузить ее из CDN:

```html
<!-- Include Eruda from CDN (Recommended) -->
<script src="https://cdn.jsdelivr.net/npm/eruda"></script>
```

Или Вы можете получить его на npm.

```bash npm2yarn
npm install eruda --save
```

### Шаг 2: Инициализируйте Eruda

Затем инициализируйте Eruda при загрузке веб-страницы. Если Вы используете Eruda с CDN, сделайте следующее:

```html
<script src="https://cdn.jsdelivr.net/npm/eruda"></script>
<script>
  // Initialize Eruda
  eruda.init();
</script>

```

Если Вы предпочитаете последние версии инструментов и пакетов, добавьте этот скрипт в свой проект:

```jsx
import eruda from 'eruda'

eruda.init()
```

### Шаг 3: Запустите Eruda

После развертывания вашего мини-приложения запустите его и просто нажмите на значок Eruda, чтобы начать отладку!

<ConceptImage style={{maxWidth:'200pt', margin: '10pt 20pt 0 0', display: 'flex-box'}} src="/img/docs/telegram-apps/eruda-2.png" />
<ConceptImage style={{maxWidth:'200pt', margin: '10pt 20pt', display: 'flex-box'}}  src="/img/docs/telegram-apps/eruda-3.png" />
